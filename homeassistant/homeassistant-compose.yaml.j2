version: '3.2'

services:
    homeassistant:
        image: ghcr.io/home-assistant/home-assistant:stable
        extra_hosts:
          - "host.docker.internal:host-gateway"
        volumes:
          - "{{ homeassistant_base_dir }}:/config"
          - /var/run/docker.sock:/var/run/docker.sock
          - /etc/localtime:/etc/localtime:ro
        ports:
          - "8123:8123"
          - "8943:8943"
        environment:
          - TZ=Europe/Warsaw
        healthcheck:
          test: 'curl -m 90 -sLf http://localhost:8123 || date >> /config/healthcheck'
          interval: 90s
          timeout: 60s
          retries: 2
        restart: unless-stopped